var fs = require('fs');
var pathUtil = require('path');
var appFile = process.cwd() + pathUtil.sep + 'config' + pathUtil.sep + 'apps';

function loadPreview (path) {
  var preview = JSON.parse(fs.readFileSync(path).toString());
  return preview;
}

exports.create = function(preview) {
  var previewFile = appFile + pathUtil.sep + preview.app + pathUtil.sep + "preview.json";
  if (fs.existsSync(previewFile)) { 
    return; 
  }
  fs.writeFileSync(previewFile, JSON.stringify(preview));
};
exports.load = function(preview) {
  var previewFile = appFile + pathUtil.sep + preview.app + pathUtil.sep + "preview.json";
  if (!fs.existsSync(previewFile)) { 
    return; 
  }
  return loadPreview(previewFile);
};
exports.write = function(preview) {
  var previewFile = appFile + pathUtil.sep + preview.app + pathUtil.sep + "preview.json";
  fs.writeFileSync(previewFile, JSON.stringify(preview));
};
